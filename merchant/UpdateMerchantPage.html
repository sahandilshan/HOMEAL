<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Update Restaurant</title>
    <link rel="icon" href="../assets/logos/Title.png"
          type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css"/>
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../css/custom.css"/>

    <style>
        #snackbar {
            visibility: hidden;
            min-width: 250px;
            margin-left: -125px;
            background-color: #209c2d;
            color: #ffffff;
            text-align: center;
            border-radius: 2px;
            padding: 6px;
            position: fixed;
            z-index: 1;
            left: 50%;
            bottom: 70px;
            font-size: 14px;
        }

        #snackbar.show {
            visibility: visible;
            -webkit-animation: fadein 0.5s, fadeout 0.5s 2.5s;
            animation: fadein 0.5s, fadeout 0.5s 2.5s;
            z-index: 100;
        }

        .side-drawer-logo {
            margin-right: auto;
            margin-left: auto;
            margin-bottom: 50px;
            display: block;
            width: 60%;
        }

        ::placeholder {
            color: #EC7A23;
            opacity: 1; /* Firefox */
        }

        :-ms-input-placeholder { /* Internet Explorer 10-11 */
            color: #EC7A23;
        }

        ::-ms-input-placeholder { /* Microsoft Edge */
            color: #EC7A23;
        }
    </style>
</head>
<body>
<div data-role="page">
    <div class="top pb-2 fixed-top">
        <img alt="home" src="../assets/otherImages/18717-min.jpg" class="banner"/>
        <div class="centered-top-home">
            <div data-role="header" class="mb-1 header m-0">
                <h1>
                    <img src="../assets/logos/MainLight.png" class="img-fluid" alt="Logo.png">
                </h1>
                <!--<button class="ui-btn-right ui-btn ui-btn-icon-notext ui-icon-notification">Notification</button>-->
            </div>
        </div>
        <!--<div class="centered-home row justify-content-center">-->
            <!--<div class="col-sm-12">-->
                <!--<a href="#popupBasicLocation" data-rel="popup" data-transition="pop"-->
                   <!--class="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-location custom-search-bar">Select-->
                    <!--Your-->
                    <!--Location</a>-->
            <!--</div>-->
        <!--</div>-->

        <!--Location Modal-->
        <div data-role="popup" id="popupBasicLocation" class="custom-location" data-position-to="window"
             data-overlay-theme="a" data-transition="pop">
            <div class="row mb-2">
                <div class="col-8">
                </div>
                <div class="col-4 custom-close-button">
                    <a href="#" data-rel="back" data-role="button" data-transition="pop"
                       class="ui-btn ui-icon-delete ui-btn-icon-notext ui-corner-all m-0">No text</a>
                </div>
            </div>
            <form>
                <div class="ui-input-search ui-body-inherit ui-corner-all ui-shadow-inset ui-input-has-clear">
                    <input data-type="search" data-enhanced="true" data-inset="false" id="pre-rendered-example-input"
                           placeholder="Search by locations..." value="">
                </div>
                <div data-role="controlgroup" data-enhanced="true" data-filter="true" data-filter-reveal="true"
                     data-input="#pre-rendered-example-input"
                     class="ui-controlgroup ui-controlgroup-vertical ui-corner-all">
                    <div class="ui-controlgroup-controls">
                        <a href="#"
                           class="ui-btn ui-corner-all ui-shadow ui-shadow ui-screen-hidden ui-btn-icon-left ui-icon-location">Colombo
                            10</a>
                        <a href="#"
                           class="ui-btn ui-corner-all ui-shadow ui-first-child ui-shadow ui-last-child ui-btn-icon-left ui-icon-location">Colombo
                            11</a>
                        <a href="#"
                           class="ui-btn ui-corner-all ui-shadow ui-shadow ui-screen-hidden ui-btn-icon-left ui-icon-location">Maradana</a>
                    </div>
                </div>
            </form>
        </div>

        <div class="ml-2 mr-2 mt-2" style="margin-top: 5px">
            <div class="row mt-n3">
                <div class="col" style="margin-top: 10px"><b>Home <font color="#ec7a23">/ Update Resturant</font></b></div>
            </div>
        </div>


    </div>

    <div class="main"> <!--content area starts from here-->
        <div class="mr-2 ml-2 mt-n4">

        <div>

            <div class="row justify-content-center" >
                <div class="col-10" style="margin-top: 20px">
                    <input style="box-shadow: 0px 5px 9px 4px #80808024" type="text"  id="merchantName" placeholder="Stone Street Pizza">
                </div>
            </div>

            <div class="row justify-content-center">
                <div class="col-10">
                    <input style="box-shadow: 0px 5px 9px 4px #80808024" type="text" id="merchantCategory" placeholder="Fast Food, Pizzeria">
                </div>
            </div>

            <div class="row justify-content-center">
                <div class="col-10">
                    <a href="#popupBasicLocation" id="selectLocation" data-rel="popup" data-transition="pop"
                       style="box-shadow: 0px 5px 9px 4px #80808024"
                       class="ui-btn ui-shadow ui-corner-all ui-btn-icon-left ui-icon-location custom-search-bar">
                        Colombo 10
                    </a>
                </div>
            </div>

            <div class="row justify-content-center">
                <div class="col-10">
                    <button class="font-2" style="background-color:#EC7A23 !important;color:white;text-shadow: none!important;border-radius:20px" >
                        Update
                    </button>
                </div>
            </div>
        </div>



        <div class="ml-2 mr-2 mt-2">

            <div class="row-12  mainTitle">
                All Products
            </div>

            <div class="row " data-role="collapsible-set" data-filter="true" data-inset="true"
                 id="collapsiblesetForFilter" data-input="#searchForCollapsibleSet">
                <!--merchants cards will be appeared here.-->
            </div>
        </div>


            <div data-role="popup" id="Update_Product" class="update-resturant-modal" data-position-to="window"
                 data-overlay-theme="a"
                 data-transition="pop" style="border-radius: 10px;height: 100%;">
                <div class="row mb-2">

                    <div class="col-2">
                        <button data-rel="back" class="ui-btn ui-btn-icon-left ui-icon-back-popup custom-back"></button>
                    </div>


                    <div class="col-10">
                        <label style="position: relative;text-align: -webkit-center;margin-left: -16%;font-size: 1.2rem;">
                            <strong>Update Product</strong>
                        </label>
                    </div>

                </div>

                <div class="row justify-content-start">
                    <div class="col-12">
                        <label style="position: relative;font-size: 1rem;">
                            <strong>Product Details</strong>
                        </label>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-12">
                        <input style="box-shadow: 0px 5px 9px 4px #80808024;font-size: 12px" type="text"
                               id="productName" placeholder="Chicken Pizza">
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-12">
                        <textarea style="box-shadow: 0px 5px 9px 4px #80808024 ;font-size: 12px" id="productDescription"
                                  rows="2" placeholder="Delicious Pizza with extra chicken"></textarea>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-12">
                        <input style="box-shadow: 0px 5px 9px 4px #80808024 ;font-size: 12px" type="text"
                               placeholder="Fast Food">
                    </div>
                </div>

                <!--<div class="row mt-n3">  &lt;!&ndash;hr line&ndash;&gt;-->
                <!--<div class="col">-->
                <!--<hr style="margin-top: 10px">-->
                <!--</div>-->
                <!--</div>-->
                <div class="row mb-2 mt-1">
                    <div class="col-6">
                        <label><strong>Variants</strong> </label>
                    </div>
                    <div class="col-6">
                        <label style="float: right;
                          border: 1px solid #EC7A23;
                          padding: 2px;
                          font-size: 12px;
                          background-color: #EC7A23 ;
                          padding-left: 10px;
                          padding-right: inherit;
                          border-radius: 6px;
                          color: #f9f9f9;
                          border-bottom-right-radius: 25px;">
                            + Add Variant
                        </label>
                    </div>
                </div>


                <div class="row mt-n3">  <!--hr line-->
                    <div class="col">
                        <hr>
                    </div>
                </div>


                <div class="row">
                    <div class="col-4">
                        <button style="border-radius: 10px;border: 1px solid #80808030;padding: 5px; font-size: 12px">
                            Large
                        </button>
                    </div>
                    <div class="col-5">
                        <button style="border-radius: 10px;border: 1px solid #80808030;padding: 5px; font-size: 12px">
                            LKR 550
                        </button>
                    </div>
                    <div class="col-2">
                        <button class="ui-btn ui-icon-back-popup custom-back"></button>
                    </div>
                </div>


                <div class="row">
                    <div class="col-4">
                        <button style="border-radius: 10px;border: 1px solid #80808030;padding: 5px; font-size: 12px">
                            Medium
                        </button>
                    </div>
                    <div class="col-5">
                        <button style="border-radius: 10px;border: 1px solid #80808030;padding: 5px; font-size: 12px">
                            LKR 450
                        </button>
                    </div>
                    <div class="col-2">
                        <button class="ui-btn ui-icon-back-popup custom-back"></button>
                    </div>
                </div>


                <!--<div class="row justify-content-start">-->
                <!--<div class="col-12">-->
                <!--<label style="position: relative;font-size: 1rem;">-->
                <!--<strong>Product Image</strong>-->
                <!--</label>-->
                <!--<img id="usser_image" src="../assets/otherImages/Men-Profile-Image.png"-->
                <!--style="width: 60px; height: 60px;border-radius: 50px;background-color: #a9a9a95e;"-->
                <!--alt="logo" >-->
                <!--</div>-->
                <!--</div>-->

                <div class="row justify-content-start">
                    <div class="col-12">
                        <label style="position: relative;font-size: 1rem;">
                            <strong>Reviews</strong>
                        </label>

                    </div>
                </div>

                <div id="prdModal-reviews">
<!--                    <div class="row">-->
<!--                        <div class="col-2 ">-->
<!--                            <img id="user_image" src="../assets/otherImages/Men-Profile-Image.png"-->
<!--                                 style="width: 60px; height: 60px;border-radius: 50px;background-color: #a9a9a95e;"-->
<!--                                 alt="logo">-->
<!--                        </div>-->
<!--                        <div class="col-10">-->
<!--                            <div class="row">-->
<!--                                <div class="col-6" style="margin-top: -5px;margin-left: 15px;">-->
<!--                                    <span class="fa fa-star prd-modal-start-checked"></span>-->
<!--                                    <span class="fa fa-star prd-modal-start-checked"></span>-->
<!--                                    <span class="fa fa-star prd-modal-start-checked"></span>-->
<!--                                    <span class="fa fa-star"></span>-->
<!--                                    <span class="fa fa-star"></span>-->
<!--                                </div>-->
<!--                                <div class="col-5 text-right">2020/11/10</div>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-top: -8px;margin-left: 15px;">John Doe</div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <p>This is a very good product</p>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <button style="background-color:transparent !important;-->
<!--                        color:gray;-->
<!--                        text-shadow: none!important;-->
<!--                        border: none;-->
<!--                        margin: 0;-->
<!--                        padding: 3px;-->
<!--                        width: fit-content;-->
<!--                        font-size: 1rem;">-->
<!--                                    Reply-->
<!--                                </button>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <div class="col-11" style="margin-left: 15px">-->
<!--                                    <input type="text" placeholder="Write a comment...">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <div class="col-2" style="margin-left: 15px">-->
<!--                                    <button style="background-color:#EC7A23 !important;-->
<!--                        color:white;-->
<!--                        text-shadow: none!important;-->
<!--                        border-radius: 8px;-->
<!--                        margin: 0;-->
<!--                        padding: 3px;-->
<!--                        width: fit-content;-->
<!--                        font-size: 0.8rem;">-->
<!--                                        Reply-->
<!--                                    </button>-->
<!--                                </div>-->
<!--                                <div class="col-2" style="margin-left: 15px">-->
<!--                                    <button style="background-color:#EC7A23 !important;-->
<!--                        color:white;-->
<!--                        text-shadow: none!important;-->
<!--                        border-radius: 8px;-->
<!--                        margin: 0;-->
<!--                        padding: 3px;-->
<!--                        width: fit-content;-->
<!--                        font-size: 0.8rem;">-->
<!--                                        Cancel-->
<!--                                    </button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                    <div class="row">-->
<!--                        <div class="col-2 ">-->
<!--                            <img id="user_image" src="../assets/otherImages/Men-Profile-Image.png"-->
<!--                                 style="width: 60px; height: 60px;border-radius: 50px;background-color: #a9a9a95e;"-->
<!--                                 alt="logo">-->
<!--                        </div>-->
<!--                        <div class="col-10">-->
<!--                            <div class="row">-->
<!--                                <div class="col-6" style="margin-top: -5px;margin-left: 15px;">-->
<!--                                    <span class="fa fa-star prd-modal-start-checked"></span>-->
<!--                                    <span class="fa fa-star prd-modal-start-checked"></span>-->
<!--                                    <span class="fa fa-star prd-modal-start-checked"></span>-->
<!--                                    <span class="fa fa-star"></span>-->
<!--                                    <span class="fa fa-star"></span>-->
<!--                                </div>-->
<!--                                <div class="col-5 text-right">2020/11/10</div>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-top: -8px;margin-left: 15px;">John Doe</div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <p>This is a very good product</p>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <button style="background-color:transparent !important;-->
<!--                        color:gray;-->
<!--                        text-shadow: none!important;-->
<!--                        border: none;-->
<!--                        margin: 0;-->
<!--                        padding: 3px;-->
<!--                        width: fit-content;-->
<!--                        font-size: 1rem;">-->
<!--                                    Reply-->
<!--                                </button>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <div class="col-11" style="margin-left: 15px">-->
<!--                                    <input type="text" placeholder="Write a comment...">-->
<!--                                </div>-->
<!--                            </div>-->
<!--                            <div class="row" style="margin-left: 15px;">-->
<!--                                <div class="col-2" style="margin-left: 15px">-->
<!--                                    <button style="background-color:#EC7A23 !important;-->
<!--                        color:white;-->
<!--                        text-shadow: none!important;-->
<!--                        border-radius: 8px;-->
<!--                        margin: 0;-->
<!--                        padding: 3px;-->
<!--                        width: fit-content;-->
<!--                        font-size: 0.8rem;">-->
<!--                                        Reply-->
<!--                                    </button>-->
<!--                                </div>-->
<!--                                <div class="col-2" style="margin-left: 15px">-->
<!--                                    <button style="background-color:#EC7A23 !important;-->
<!--                        color:white;-->
<!--                        text-shadow: none!important;-->
<!--                        border-radius: 8px;-->
<!--                        margin: 0;-->
<!--                        padding: 3px;-->
<!--                        width: fit-content;-->
<!--                        font-size: 0.8rem;">-->
<!--                                        Cancel-->
<!--                                    </button>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
                </div>
                <div id="snackbar">Reply Added.</div>
            </div>
        </div>
    </div>

    <!--Footer-->
    <div class="footer">
        <div class="row justify-content-between">
            <div class="col d-flex justify-content-left ml-3 p-3">
                <img src="../assets/logos/AltDark.png" class="img-fluid" alt="logo">
            </div>
            <div class="col mr-3 p-3">
                <div class="row">
                    <div class="col font1">Privacy Policy Terms of Use</div>
                    <div class="w-100"></div>
                    <div class="col font2">© 2020 HOMEAL. All rights reserved</div>
                </div>
            </div>
        </div>
    </div>

    <div data-role="footer" class="fixed-bottom">
        <nav data-role="navbar">
            <ul>
                <li><a href="#" class="ui-btn ui-icon-home ui-btn-icon-top ui-btn-active ui-state-persist">Home</a></li>
                <li><a href="#Update_Product" data-rel="popup" data-transition="pop"
                       class="ui-btn ui-icon-profile ui-btn-icon-top">Dashboard</a></li>
                <li><a href="#" class="ui-btn ui-icon-cart ui-btn-icon-top">Add Restaurant</a></li>
                <li><a href="#side-drawer" class="ui-btn ui-icon-profile ui-btn-icon-top">Profile</a></li>
            </ul>
        </nav>
    </div>
    <div data-role="panel" data-position="right" data-display="overlay" data-theme="a" id="side-drawer"
         style="z-index: 1400">
                
        <div><img src="../assets/logos/MainLight.png" class="side-drawer-logo"></div>
        <ul data-role="listview">
            <li data-icon="false"><a href="Home.html" class="side-drawer-option">My Account</a></li>
            <li data-icon="false"><a href="#" class="side-drawer-option">Location</a></li>
            <li data-icon="false"><a href="Merchant.html" class="side-drawer-option"> Payment</a></li>
            <li data-icon="false"><a href="../profile/Help-about.html" class="side-drawer-option">Help/About</a></li>
            <li data-icon="false"><a href="" class="side-drawer-option"> Favorites</a></li>
            <li data-icon="false"><a href="../profile/Acheivements.html" class="side-drawer-option">Acheivements</a></li>
            <li data-icon="false"><a href="#" class="side-drawer-option">Logout</a></li>
        </ul>
            
    </div><!-- /panel -->
</div>
</body>

<script>

    let merchant_id = '';
    let productsArr;
    let productsJsonArr; // array with merchants id
    let user;


    $.mobile.ajaxEnabled = false;
    $(document).ready(function () {
        let merchantJsonArray = JSON.parse(sessionStorage.getItem('merchants'));
        productsJsonArr = JSON.parse(sessionStorage.getItem('products'));
        console.log(productsJsonArr)
        let searchParams = new URLSearchParams(window.location.search);
        user = JSON.parse(sessionStorage.getItem('user'));
        if (searchParams.has('merchant_id')) {
            merchant_id = searchParams.get('merchant_id');
            console.log("Merchant id: ", merchant_id);
        } else {
            console.log("merchant id could not extract from the url.");
        }

        $.each(merchantJsonArray, function (i, merchant) {
            if (merchant['merchant_id'] === merchant_id) {
                $('#merchantName').attr("placeholder", merchant['merchant_name']);
                $('#merchantCategory').attr("placeholder", merchant['merchant_category']);
                $('#selectLocation').text(merchant['merchantLocation']);
                return false;
            }
        });
        // loading products
        let products = '<div class="row mt-1 ml-2 mr-2">';
        $.each(productsJsonArr, function (i, product) {
            if (merchant_id === product['merchant_id']) {
                productsArr = product['products'];
                productsArr.forEach(function (product) {
                    products +=
                        `
                            <div class="col-6 col-sm-3 col-md-3" data-filtertext="${product['filter_text']}">
                                <div class="product-card" data-pid=${product['product_id']}>
                                    <div class="product-card-image">
                                        <img alt="home" src="${product['product_img_path']}" style="width: 100%;"/>

                            `;
                    products += `
                              </div>
                                    <div class="col pl-2 pb-1">
                                        <div class="row">
                                            <div class="col-8 product-name">
                                            ${product['product_name']}
                                            </div>
                                            `;

                    products += `<div class="col-4 favorite_icon" data-pid=${product['product_id']}
                                              data-fav="1" style="padding-right: 5px;text-align: -webkit-right;">
                                             <img src="../assets/icons/delete_icon.png"
                                         style="border-radius: 10px;  height: 20px;width:20px;!important; object-fit: cover;"
                                         alt="Card image">
                                            </div>`


                    products += `</div>
                                        <div class="row-12 product-price">LKR ${product.variants[0].price}.00</div>
                                    </div>

                                </div>
                              </div>
                        `
                });
                return false;
                /*to break from the loop*/
            }
        });
        products += '</div>';
        $("#collapsiblesetForFilter").append(products);
        /*to break from the loop*/
    });

    let selected_product;

    // Loading product update modal
    $(document).on('click', '.product-card', function() {
        let selected_product_id = $(this).data('pid');
        $.each(productsArr, function (i, product) {
            if (product['product_id'] === selected_product_id) {
                selected_product = product;
                return false;
            }
        });
        $('#productName').attr('placeholder', selected_product['product_name']);
        $('#productDescription').attr('placeholder', selected_product['product_description']);
        loadReviews(selected_product['reviews']);
        $('#Update_Product').popup('open');
    });

    function loadReviews(prdReviews) {
        let reviews = '';
        prdReviews.forEach(function (review) {
            reviews += `
            <div class="row">
                    <div class="col-2 ">
                        <img src="../assets/otherImages/Men-Profile-Image.png"
                             style="width: 60px; height: 60px;border-radius: 50px;background-color: #a9a9a95e;"
                             alt="logo">
                    </div>
                    <div class="col-10">
                        <div class="row">
                            <div class="col-6" style="margin-top: -5px;margin-left: 15px;">`;
            switch (review['rating']) {
                case '1': {
                    reviews += `<span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>`;
                    break;
                }
                case '2': {
                    reviews += `<span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>`;
                    break;
                }
                case '3': {
                    reviews += `<span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star"></span>
                            <span class="fa fa-star"></span>`;
                    break;
                }
                case '4': {
                    reviews += `<span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star"></span>`;
                    break;
                }
                case '5': {
                    reviews += `<span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>
                            <span class="fa fa-star prd-modal-start-checked"></span>`;
                    break;
                }
            }
            reviews +=
                `</div>
                            <div class="col-5 text-right">${review['date']}</div>
                        </div>
                        <div class="row" style="margin-top: -8px;margin-left: 15px;">${review['user_name']}</div>
                        <div class="row" style="margin-left: 15px;">
                            <p>${review['review_content']}</p>
                        </div>
                        <div class="row" style="margin-left: 15px;">
                            <button class="reply1" data-review-id="${review['review_id']}" style="background-color:transparent !important;
                    color:gray;
                    text-shadow: none!important;
                    border: none;
                    margin: 0;
                    padding: 3px;
                    width: fit-content;
                    font-size: 1rem;">
                                Reply
                            </button>
                        </div>

                        <div id="reply_${review['review_id']}" class="row" style="margin-left: 15px;">
                            <div class="col-11" style="margin-left: 15px">
                                <input id="reply_text_${review['review_id']}" type="text">
                            </div>
                        </div>
                        <div id="btns_${review['review_id']}" class="row" style="margin-left: 15px;">
                            <div id="reply2_${review['review_id']}" class="col-2 reply2"
                            data-review-id="${review['review_id']}" style="margin-left: 15px">
                                <button id="reply_btn_${review['review_id']}" style="background-color:#EC7A23 !important;
                    color:white;
                    text-shadow: none!important;
                    border-radius: 8px;
                    margin: 0;
                    padding: 3px;
                    width: fit-content;
                    font-size: 0.8rem;">
                                    Reply
                                </button>
                            </div>
                            <div id="cancel_${review['review_id']}"  data-review-id="${review['review_id']}"
                             class="col-2 cancel" style="margin-left: 15px">
                                <button style="background-color:#EC7A23 !important;
                    color:white;
                    text-shadow: none!important;
                    border-radius: 8px;
                    margin: 0;
                    padding: 3px;
                    width: fit-content;
                    font-size: 0.8rem;">
                                    Cancel
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        })
        $("#prdModal-reviews").html(reviews);
        prdReviews.forEach(function (review) {
            $('#btns_' + review['review_id']).hide();
            $('#reply_' + review['review_id']).hide();
        });
    }

    $(document).on('click', '.reply1', function () {
        let review_id = $(this).data('review-id').toString();
        let btns = $('#btns_' + review_id);
        let reply = $('#reply_' + review_id);
        if (btns.is(":hidden")) {
            let reviews = selected_product['reviews'];
            reviews.forEach(function (review) {
               if (review['review_id'] === review_id) {
                   let reviewReply = review['reply'];
                   let placeholderText = 'Write a reply';
                   let btn_reply_text = 'Reply';
                   if (reviewReply) {
                       placeholderText = reviewReply;
                       btn_reply_text = 'Edit';
                   }
                   $('#reply_text_' + review_id).attr('placeholder', placeholderText);
                   $('#reply_btn_' + review_id).text(btn_reply_text);
                   return false;
               }
            });
            btns.show();
            reply.show();
        } else {
            btns.hide();
            reply.hide();
            $('#reply_text_' + review_id).val('');
        }

    });

    $(document).on('click', '.reply2', function () {
        let review_id = $(this).data('review-id').toString();
        let replyText = $('#reply_text_' + review_id).val();
        selected_product['reviews'].forEach(function (review) {
            if (review['review_id'] === review_id) {
                review['reply'] = replyText;
                $('#reply_' + review_id).hide(); //clearing
                $('#btns_' + review_id).hide();
                $('#reply_text_' + review_id).val('');
                let x = document.getElementById("snackbar");
                x.className = "show";
                setTimeout(function(){ x.className = x.className.replace("show", ""); }, 3000);
                return false;
            }
        });
        console.log(selected_product)
        console.log(productsArr);
        sessionStorage.setItem('products', JSON.stringify(productsJsonArr));
    });

    $(document).on('click', '.cancel', function () {
        /*let x = `
        {
            "user": "Sahan",
            "test": "1234"
        }
        `
        let json = JSON.parse(x);
        console.log(json);
        json['test'] = '4321';
        console.log(json)

        json['test1'] = "test"
        console.log(json)*/
        let review_id = $(this).data('review-id');
        $('#reply_' + review_id).hide();
        $('#btns_' + review_id).hide();
        $('#reply_text_' + review_id).val('');

    });

</script>

</html>
